import React, { Component } from 'react';
import 'bootstrap/dist/css/bootstrap.min.css';
import './QuizApp.css';
import Quiz from './quiz-modules/Quiz';
import { connect } from 'react-redux';
import { ActionTypes } from '../../../state-management/actions/constants';
//import store from '../../../state-management/store';

const mapStateToProps = state => { return { ...state.quiz } };

const mapDispatchToProps = dispatch => ({
  onQuizLoad: payload => dispatch({ type: ActionTypes.QuizLoad, payload }),
  onPagerUpdate: payload => dispatch({ type: ActionTypes.PagerUpdate, payload })
});

/*const clusterDictionary={
  "Cluster_01":["11-9013.03","13-1021.00","11-9013.02","13-1074.00","11-9013.00","11-9013.01","45-2021.00","19-1011.00","45-2093.00","39-2021.00","17-3025.00","17-2081.00","19-4091.00","47-4041.00","37-2021.00","53-7081.00","51-8031.00","17-2081.01","19-4011.00","19-4011.01","45-1011.07","45-1011.08","45-1011.06","45-1011.00","45-1011.05","19-4011.02","19-1012.00","45-2041.00","11-9121.01","45-4021.00","45-3011.00","19-4093.00","45-4011.00","19-1032.00","19-4041.00","19-4041.02","19-4041.01","45-3021.00","45-4023.00","45-4022.00","45-4029.00","11-9121.00","11-9121.02","19-1023.00","45-2099.00","19-4021.00","45-2092.02","45-2092.00","45-2092.01","37-3012.00","19-1013.00","37-3013.00","17-2021.00","45-2091.00","49-3041.00"],
  "Cluster_02":["47-2021.00","47-2031.00","47-2041.00","47-2051.00","47-2031.01","47-2061.00","11-9021.00","47-5041.00","53-7011.00","53-7021.00","47-5011.00","53-7031.00","47-2081.00","47-5021.00","47-2111.00","53-7032.00","47-5031.00","47-5099.00","47-4031.00","47-1011.00","47-2042.00","47-2043.00","47-2121.00","47-3019.00","47-3011.00","47-3012.00","47-3013.00","47-5081.00","47-3014.00","47-3015.00","47-3016.00","53-7041.00","47-2131.00","47-2132.00","53-7033.00","49-9095.00","47-5042.00","47-5049.00","47-2073.00","47-2141.00","47-2142.00","47-2071.00","47-2072.00","47-2152.01","47-2151.00","47-2161.00","47-2152.02","47-2152.00","47-2171.00","49-9096.00","47-5051.00","47-5061.00","47-2181.00","47-5012.00","47-2031.02","47-5071.00","47-4091.00","47-5013.00","47-2211.00","47-1011.03","47-2231.00","47-2022.00","47-2221.00","51-2041.00","47-2082.00","47-2053.00","47-2044.00","17-1011.00","17-3011.00","17-3011.01","17-3011.02","17-3022.00","17-2051.00","13-1051.00","17-1022.01","27-1025.00","17-1012.00","17-3031.02","17-3031.00","17-3031.01","17-1022.00","17-2051.01","47-2011.00","49-9092.00","47-4099.00","49-9012.00","49-9051.00","47-4021.00","37-1012.00","37-3019.00","49-9021.01","49-9021.00","49-9098.00","47-4051.00","37-3011.00","49-9011.00","49-9044.00","49-9045.00","49-9021.02","47-4071.00","47-4099.02","51-8021.00","47-4099.03"],
  "Cluster_03":["27-4011.00","27-3021.00","27-4012.00","27-4031.00","27-3043.04","27-3041.00","27-4032.00","27-4099.00","27-3099.00","27-4021.00","27-3043.05","27-3011.00","27-4013.00","27-3022.00","27-4014.00","27-3042.00","27-3043.00","27-2011.00","13-1011.00","27-2032.00","39-3092.00","27-2031.00","27-2012.02","27-2099.00","39-5091.00","27-2041.04","27-2041.01","27-2041.00","27-2042.00","27-2042.02","27-2012.01","27-2012.00","27-2012.03","27-3012.00","27-2042.01","27-2012.04","27-2012.05","43-9031.00","51-5111.00","51-5113.00","51-5112.00","43-9081.00","49-2022.00","49-9052.00","27-1011.00","27-1019.00","27-1021.00","27-1012.00","27-1029.00","27-1022.00","27-1013.00","27-1023.00","27-1024.00","27-1014.00","27-1027.00"],
  "Cluster_04":["43-3031.00","43-2099.00","43-9011.00","43-4021.00","43-4051.00","43-9021.00","43-6011.00","43-4071.00","43-1011.00","43-4161.00","43-4199.00","43-4111.00","43-4121.00","43-9051.00","43-5081.02","43-5041.00","43-4141.00","43-9199.00","43-9061.00","43-9071.00","43-4151.00","43-5081.04","43-4051.03","43-3051.00","43-5051.00","43-5052.00","43-5053.00","43-3061.00","43-4171.00","43-6014.00","43-5071.00","43-5081.00","43-5081.01","43-5081.03","43-2011.00","43-2021.00","43-9022.00","11-3021.00","11-9199.11","11-1011.00","11-1011.03","11-9199.02","11-1021.00","11-9199.03","11-9199.08","11-9199.00","11-9199.01","11-9199.07","11-9199.04","11-9199.09","11-9199.10","11-3111.00","13-1141.00","11-3121.00","13-1071.00","13-1075.00","11-3131.00","13-1151.00","11-3011.00","11-3051.03","11-3051.04","13-1199.04","13-1199.00","13-1199.03","13-1199.01","13-1131.00","11-3051.02","11-3051.06","11-3051.00","13-1111.00","13-1121.00","11-3051.05","13-1199.06","15-2031.00","11-3061.00","11-3051.01","13-1199.02","13-1199.05"],
  "Cluster_05":["11-9039.01","11-9039.00","11-9032.00","11-9033.00","11-9031.00","11-9039.02","25-4011.00","25-9011.00","25-4012.00","21-1012.00","25-9031.00","25-9031.01","27-3091.00","25-4021.00","25-4031.00","25-4013.00","25-2059.01","25-3011.00","25-1041.00","25-1061.00","25-1031.00","25-1062.00","25-1121.00","25-1051.00","25-1042.00","25-1011.00","25-2023.00","25-2032.00","25-1052.00","27-2022.00","25-1122.00","25-1021.00","25-1111.00","25-1063.00","25-1081.00","25-9099.00","25-2021.00","25-1032.00","25-1123.00","25-1053.00","25-9021.00","25-1124.00","25-1043.00","25-1064.00","25-1191.00","25-1071.00","25-1125.00","25-1192.00","25-2012.00","25-1112.00","25-1082.00","25-1022.00","25-2022.00","25-1072.00","25-1126.00","25-1054.00","25-1065.00","25-1199.00","25-2011.00","25-1066.00","25-1193.00","25-2031.00","25-3021.00","25-1069.00","25-1113.00","25-1067.00","25-2059.00","25-2052.00","25-2053.00","25-2051.00","25-2054.00","25-9041.00","25-3099.00","25-3099.02","25-1194.00"],
  "Cluster_06":["13-2011.01","13-2011.00","13-2011.02","43-3011.00","13-2041.00","43-4041.01","43-4041.00","43-4041.02","43-3099.00","43-4131.00","13-2072.00","43-3071.00","13-2031.00","13-2051.00","11-3031.00","11-3031.02","13-2082.00","11-3031.01","15-2011.00","13-1031.00","13-1031.01","13-1031.02","13-1032.00","43-9041.00","43-9041.01","43-9041.02","41-3021.00","13-2053.00","43-4011.00","13-2099.01","13-2099.00","13-2099.04","13-2099.03","13-2052.00","13-2099.02","41-3031.02","41-3031.01","41-3031.03","41-3031.00"],
  "Cluster_07":["53-6051.01","13-1041.00","13-1041.06","13-1041.01","13-1041.03","13-2061.00","53-6051.08","13-1041.04","11-1031.00","13-1041.02","13-1041.07","53-6051.00","53-6051.07","55-3011.00","55-1011.00","55-1012.00","55-3012.00","55-3013.00","55-1013.00","55-3014.00","55-1014.00","55-1015.00","55-3015.00","55-2011.00","55-2013.00","55-2012.00","55-3016.00","55-1016.00","55-3019.00","55-1019.00","55-3017.00","55-3018.00","55-1017.00","33-9093.00","43-9111.01","43-9111.00","19-3051.00","43-4031.01","43-4031.00","43-4061.00","11-9161.00","43-4031.03","43-4031.02","11-9131.00","45-2011.00","47-4011.00","29-9011.00","29-9012.00","13-2021.00","13-2021.02","13-2021.01","13-2081.00"],
  "Cluster_08":["17-2031.00","19-1042.00","29-2031.00","29-2011.01","29-2011.02","29-2032.00","19-1041.00","29-2099.00","29-2011.03","29-2035.00","29-2012.00","29-2011.00","29-2099.01","29-2033.00","29-2099.05","29-2099.06","29-2034.00","29-2099.07","29-2056.00","29-2071.00","43-6013.00","31-9094.00","31-9099.02","31-9099.00","11-9111.00","31-9093.00","31-1015.00","31-9095.00","31-9097.00","31-9099.01","31-9096.00","29-1199.01","29-1141.01","29-1141.02","29-1069.01","29-1071.01","29-1061.00","29-1125.01","29-9091.00","29-1181.00","29-1011.00","29-1141.04","29-1141.03","31-9091.00","29-2021.00","29-1029.00","29-1021.00","29-1069.02","29-2051.00","29-1031.00","29-1128.00","29-1062.00","29-9092.00","29-1199.00","29-9099.00","29-2092.00","31-1011.00","29-1069.03","29-1063.00","29-2061.00","29-1122.01","31-9092.00","29-9099.01","29-1125.02","29-1199.04","29-1069.04","29-1069.05","29-1151.00","29-1161.00","29-1171.00","31-1014.00","29-1064.00","29-1122.00","31-2012.00","31-2011.00","29-2057.00","29-1069.06","29-2081.00","29-1041.00","29-1022.00","29-1023.00","29-1199.05","29-2091.00","29-1069.07","29-1065.00","29-1051.00","29-2052.00","29-1069.08","31-2022.00","31-2021.00","29-1123.00","29-1071.00","29-1069.00","29-1081.00","29-1069.09","29-1024.00","31-1013.00","29-2053.00","29-1066.00","29-1124.00","29-1069.10","29-1125.00","29-1141.00","29-1126.00","29-2054.00","29-1127.00","29-1069.11","29-1067.00","29-2055.00","29-1129.00","29-1069.12","29-1131.00"],
  "Cluster_09":["39-6011.00","37-2019.00","39-6012.00","37-1011.00","43-4081.00","37-2011.00","11-9081.00","37-2012.00","39-3091.00","39-2011.00","27-2021.00","39-3099.00","39-3012.00","43-3041.00","41-2012.00","39-3011.00","11-9071.00","39-3019.00","39-1011.00","39-3021.00","39-9032.00","39-1012.00","27-2023.00","39-3031.00","51-3011.00","35-3022.01","35-3011.00","35-1011.00","35-3021.00","35-2019.00","35-2011.00","35-2012.00","35-2013.00","35-2014.00","35-2015.00","35-3022.00","35-9011.00","35-9021.00","35-1012.00","35-9099.00","35-2021.00","35-3041.00","11-9051.00","35-9031.00","35-3031.00","43-4181.00","39-7011.00","41-3041.00","39-7012.00"],
  "Cluster_10":["13-2071.00","13-2071.01","19-3031.02","19-3031.00","19-3031.03","21-1019.00","19-3032.00","21-1013.00","21-1023.00","21-1014.00","19-3039.01","19-3039.00","21-1015.00","19-3031.01","21-1011.00","39-9011.00","39-9011.01","21-1021.00","21-2011.00","21-1099.00","21-1094.00","21-2021.00","21-1091.00","21-1022.00","21-2099.00","11-9151.00","21-1093.00","21-1029.00","39-5011.00","39-4011.00","39-1021.00","39-9031.00","39-4021.00","11-9061.00","39-5012.00","51-6011.00","39-3093.00","39-5092.00","31-9011.00","39-4031.00","39-9021.00","39-9099.00","51-6021.00","39-9041.00","39-5093.00","39-5094.00","39-1021.01","51-6052.00"],
  "Cluster_11":["15-1199.08","15-1199.00","15-1199.02","15-1151.00","15-1199.07","15-1199.06","15-1199.12","15-1199.05","15-1199.04","15-1199.09","15-1199.10","15-1199.01","15-1199.11","15-1199.03","15-1143.00","15-1152.00","15-1141.00","15-1122.00","15-1142.00","15-1143.01","15-1131.00","15-1121.00","15-1121.01","15-1132.00","15-1133.00","15-1134.00"],
  "Cluster_12":["33-3012.00","33-1011.00","21-1092.00","29-2041.00","33-2021.01","33-2021.00","33-2021.02","33-2011.00","33-1021.00","33-1021.02","33-2022.00","33-2011.02","33-1021.01","33-2011.01","43-5031.00","33-9011.00","33-3021.03","33-3021.00","33-1012.00","33-3031.00","19-4092.00","33-3021.05","33-3021.06","33-3041.00","33-3051.00","33-3021.01","33-3021.02","33-3051.01","33-9021.00","33-3051.03","33-3052.00","23-1021.00","23-1022.00","23-2091.00","23-1023.00","23-1012.00","23-1011.00","43-6012.00","23-2099.00","23-2011.00","23-2093.00","33-3011.00","33-9091.00","33-1099.00","33-9031.00","33-9092.00","33-9099.00","33-9099.02","33-9032.00"],
  "Cluster_13":["49-9061.00","49-9091.00","49-2011.00","49-2092.00","49-2094.00","49-2095.00","49-2097.00","49-9093.00","49-1011.00","49-9099.01","49-9031.00","49-9041.00","49-9099.00","49-9094.00","49-9071.00","49-9043.00","51-9082.00","49-9062.00","49-9063.00","49-3053.00","49-9069.00","49-2021.01","49-2021.00","49-2098.00","49-9064.00","49-9081.00","17-3021.00","17-3027.01","19-4031.00","17-3019.00","17-3023.00","17-3012.00","17-3012.02","17-3023.03","17-3029.02","17-3024.00","17-3029.03","17-3012.01","17-3023.01","17-3029.04","17-3029.00","17-3029.10","17-3026.00","17-3029.05","17-3029.06","17-3029.09","17-3013.00","17-3027.00","17-3029.07","17-3029.12","17-3029.11","17-3029.01","19-4051.01","19-4051.02","19-4051.00","17-3029.08","13-1023.00","17-3024.01","51-9191.00","51-2011.00","51-2099.00","51-8099.01","51-8099.03","51-3021.00","51-7011.00","51-9011.00","51-8091.00","51-9192.00","51-9121.00","51-2021.00","51-4012.00","51-4011.00","51-9193.00","51-9021.00","51-9031.00","51-9032.00","51-4031.00","51-9081.00","51-4032.00","51-2022.00","51-2023.00","51-2031.00","51-9194.00","51-4021.00","51-6091.00","51-9041.00","51-6092.00","51-2091.00","51-1011.00","51-3091.00","51-3092.00","51-3093.00","51-3099.00","51-4022.00","51-4071.00","51-9051.00","51-7021.00","51-8092.00","51-9071.06","51-9195.04","51-9022.00","51-4033.00","51-4191.00","51-9198.00","51-8099.04","51-9071.01","51-9071.00","51-4034.00","51-4192.00","53-7063.00","51-4041.00","51-3022.00","51-4199.00","51-4051.00","51-8099.02","51-4035.00","51-9023.00","51-4061.00","51-7031.00","51-9195.00","51-9195.07","51-4072.00","51-4081.00","51-8011.00","51-9083.00","51-9111.00","51-9122.00","51-9123.00","51-9196.00","51-4062.00","51-7032.00","51-8093.00","51-9151.00","51-8099.00","51-4193.00","51-9195.05","51-4052.00","51-8012.00","51-8013.00","51-9071.07","51-9199.00","51-9199.01","51-4023.00","51-7041.00","51-9141.00","51-9012.00","51-6051.00","51-6031.00","51-6041.00","51-6042.00","51-3023.00","51-4121.07","51-9195.03","51-2092.00","51-6061.00","51-6062.00","51-6063.00","51-6064.00","51-6099.00","51-2093.00","51-9197.00","51-4111.00","51-4194.00","51-6093.00","51-4121.06","51-4121.00","51-4122.00","51-7099.00","51-7042.00","51-9061.00","43-5061.00","43-5111.00"],
  "Cluster_14":["27-3031.00","11-2011.00","11-2011.01","11-2021.00","11-9141.00","11-2031.00","11-2022.00","13-1161.00","27-1026.00","41-9012.00","13-1022.00","41-3011.00","41-2011.00","41-2021.00","41-9011.00","41-9091.00","53-3031.00","41-3099.01","41-1012.00","41-1011.00","41-2022.00","41-9021.00","41-9022.00","41-2031.00","41-9099.00","41-9031.00","41-3099.00","41-4012.00","41-4011.00","41-4011.07","41-9041.00"],
  "Cluster_15":["17-2011.00","11-9041.00","17-2141.02","17-2199.01","11-9041.01","17-2041.00","17-2061.00","17-2071.00","17-2072.00","17-2199.03","17-2199.00","17-2111.02","17-2141.01","17-2111.00","17-2112.01","17-2112.00","17-2111.01","17-2199.04","17-2121.02","17-2121.01","17-2121.00","17-2131.00","17-2141.00","17-2199.05","17-2199.06","17-2151.00","17-2199.09","17-2161.00","17-2171.00","17-2199.07","17-2111.03","17-2072.01","17-2199.08","17-2199.11","17-2199.02","17-2199.10","19-3091.01","19-3091.00","19-3091.02","19-2011.00","19-2021.00","19-1021.00","19-1029.01","19-1029.00","15-2041.01","17-1021.00","19-2031.00","19-4061.01","19-2041.01","15-2041.02","15-1111.00","19-1031.00","19-3011.00","19-3011.01","19-2041.02","19-2041.00","19-1029.03","19-3092.00","19-2042.00","19-3093.00","19-2043.00","19-2041.03","19-1099.00","19-4099.00","19-2032.00","15-2099.00","15-2091.00","15-2021.00","19-1022.00","19-1029.02","19-1031.03","19-2099.00","19-2012.00","19-3094.00","19-4099.02","19-4099.01","19-1031.02","19-2099.01","19-4099.03","19-4061.00","19-3099.00","19-3041.00","19-1031.01","15-2041.00","19-3022.00","19-3099.01"],
  "Cluster_16":["49-3011.00","53-6031.00","49-3021.00","49-3022.00","49-3023.01","49-3023.00","49-3023.02","49-2091.00","49-3091.00","49-3031.00","53-7061.00","49-2093.00","49-2096.00","49-3042.00","49-3051.00","49-3052.00","49-3043.00","47-4061.00","49-3092.00","49-9097.00","49-3093.00","43-5032.00","13-1081.00","13-1081.02","13-1081.01","11-3071.03","11-3071.02","11-3071.01","11-3071.00","43-3021.00","43-3021.02","43-5011.00","43-5011.01","53-6021.00","43-3021.01","53-1011.00","53-2011.00","53-3011.00","53-6011.00","53-3022.00","53-3021.00","53-5021.00","53-2012.00","43-5021.00","53-1021.00","53-1031.00","53-2031.00","53-7071.00","53-3032.00","53-7051.00","53-7062.00","53-3033.00","53-4011.00","53-4012.00","53-7199.00","53-5021.02","53-7111.00","53-3099.00","53-5022.00","53-7064.00","53-5021.03","53-7072.00","53-4099.00","53-4013.00","53-4021.00","53-4031.00","53-1021.01","53-5011.00","53-5021.01","53-5031.00","53-4041.00","53-7121.00","53-3041.00","53-6061.00","53-6099.00","53-7073.00","53-2021.00","53-2022.00","53-6041.00"]
  };*/

class QuizApp extends Component {
  
  state = {
    quizes: [
      { id: 'data/Cluster_01.json', name: 'Agriculture'},
      { id: 'data/Cluster_02.json', name: 'Architecture & Construction'},
      { id: 'data/Cluster_03.json', name: 'Arts, A/V Tech. & Communications'},
      { id: 'data/Cluster_04.json', name: 'Business Management & Administration'},
      { id: 'data/Cluster_05.json', name: 'Education & Training'},
      { id: 'data/Cluster_06.json', name: 'Finance'},
      { id: 'data/Cluster_07.json', name: 'Government & Public Administration'},
      { id: 'data/Cluster_08.json', name: 'Health Science'},
      { id: 'data/Cluster_09.json', name: 'Hospitality & Tourism'},
      { id: 'data/Cluster_10.json', name: 'Human Services'},
      { id: 'data/Cluster_11.json', name: 'Information Technology'},
      { id: 'data/Cluster_12.json', name: 'Law, Public Safety, Corrections & Security'},
      { id: 'data/Cluster_13.json', name: 'Manufacturing'},
      { id: 'data/Cluster_14.json', name: 'Marketing'},
      { id: 'data/Cluster_15.json', name: 'Science, Technology, Engineering & Mathematics'},
      { id: 'data/Cluster_16.json', name: 'Transportation, Distribution & Logistics'}
    ],
    quizId: 'data/Cluster_01.json'
  };

  pager = {
    index: 0,
    size: 1,
    count: 1
  }

  /*getCluster() {
    let dataState = store.getState();
    for (const cluster of Object.keys(clusterDictionary)) {
      clusterDictionary[cluster].forEach(element => {
        if (element == dataState.career.career)
        {
          // console.log for testing
          console.log("career: ", dataState.career.career)
          console.log("cluster: ", cluster);
          console.log("element: ", element);
        }
      });
    }
  }*/

  componentDidMount() {
    this.load(this.state.quizId);
  }

  load(quizId) {
    let url = quizId || this.props.quizId;
    console.log("quizId: ", quizId);
    console.log("quiz data: ", JSON.stringify(quizId));
    fetch(`../${url}`).then(res => res.json()).then(res => {
      let quiz = res;
      console.log("Quiz name: ", quiz.name);
      quiz.questions.forEach(q => {
        q.options.forEach(o => o.selected = false);
      });
      quiz.config = Object.assign(this.props.quiz.config || {}, quiz.config);
      this.pager.count = quiz.questions.length / this.pager.size;
      this.props.onQuizLoad(quiz);
      this.props.onPagerUpdate(this.pager);
    });
  }

  onChange = (e) => {
    this.setState({ quizId: e.target.value });
    this.load(e.target.value);
  };

  render() {
    return (
      <div className="container">
        <header className="p-2">
          <div className="row">
            <div className="col-6">
              <h1>Exploration Experience</h1>
            </div>
            <div className="col-6 text-right">
              <label className="mr-1">Choose a cluster to begin earning experience:</label>
              <select onChange={this.onChange}>
                {this.state.quizes.map(q => <option key={q.id} value={q.id}>{q.name}</option>)}
              </select>
            </div>
          </div>
        </header>
        <Quiz quiz={this.state.quiz} quizId={this.state.quizId} mode={this.state.mode} />
      </div>
    );
  }
}


export default connect(mapStateToProps, mapDispatchToProps)(QuizApp);
